## Linux Enumeration Commands

### Areas of Enumeration

#### Users

Enumerating these can help determine vulnerable accounts or knowing services that are running on the machine

```bash
# Show current user only
whoami
# Show user, groups, and ID's
id
# Show other users
# You can sometimes determine services on the machine by looking at service accounts in this file too
cat /etc/passwd
```

#### Hostname

This can help determine the purpose, location, etc of the machine

```bash
# Show hostname
hostname
```

#### System OS & Architecture

Some exploits are built for specific kernels or OS's and may cause a crash if not used on those versions.

```bash
# Show OS version
cat /etc/issue
cat /etc/*-release

# Show kernel version & architecture
uname -a 

# Kernel
uname -r

# Architecture
arch
```

#### Running Processes & Services

Check which processes are running as root/admin and see if there are exploits for those processes

```bash
ps aux
```

Investigate services that are running as root for potential vulnerabilities.

#### Environment Variables

```bash
env
```

#### Network Information

If something is connected to multiple networks, it could be used as a pivot point (or you could pivot from it to get by ACL's & Firewalls).  Some services can only be attacked from a loopback address.

```bash
# Show adapter config
ip a
# OR 
ifconfig a

# Show routing table
route
# OR in some distros
routel

# Show active network connections
ss -anp
# OR
netstat -anp
# OR
sudo netstat -tulpn

# Options
a 	# All connections
n	# Numeric IP/ports
p	# Show process connection belongs to
```

#### Firewall Status and Rules

Normally this is only relevant during remote attacks, but can be helpful to find things like local-only services blocked by the firewall or for port forwarding for pivoting.

You need root privileges to list iptables rules but you can work around this by looking for commands used to build rules.

```bash
# Look for commands used to build iptables
grep -Hs iptables /etc/*

# Options
-H	# Show files
-s	# Suppress errors
```

#### Scheduled Tasks

Check for insecure files referenced by tasks and see if the files can be modified.  You can use these to let the task scheduler run them as root for you.

```bash
# Show cron directories and the tasks setup in them
ls -lah /etc/cron*
# Show added tasks for the user
cat /etc/crontab
```

#### Installed Applications and Patch Levels

May need exploit to escalate privileges.  On Windows also need to know OS Patch level

```bash
# Depends on the package manager
dpkg -l
```

#### Readable/Writable Files and Directories

Incorrect permissions can provide a method of running code under the context of a privileged account or provide access to sensitive files

```bash
# Find every file writeable by current user
# See Linux/File Cmds/Search/find.md for more info
find / -writable -type d 2>/dev/null

# Options
-writable	# Look for write access
-type d		# Match directories
2>/dev/null	# Send errors to null
```

#### Unmounted Disks

Usually drives are auto-mounted, but always check for unmounted drives or partitions which may have sensitive info

```bash
# Show all mount information
mount

# Show boot-time mounts
cat /etc/fstab

# Show all available disks
/bin/lsblk
```

#### Device Drivers and Kernel Modules

Driver and module versions are needed when using exploits.

To get a general list of loaded modules:

```bash
lsmod
```

To get more info about a module (ex. libata):

```bash
# Note, this requires the full path to run
/sbin/modinfo libata
```

#### Binaries that AutoElevate

Finding these provide a shortcut to privilege escalation.

Look for files with SUID set owned by root, which allows a user to execute the binary with the privileges of the owner (root).

```bash
find / -perm -u=s -type f 2>/dev/null
# Options
-perm -u=s	# Look for SUID permission
-type f	# Search files
```

