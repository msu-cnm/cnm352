## NFS Discovery

*For more info on nmap, see documentation under Pentest Cmds -> Active Scans -> Port-Scans*

To find NFS exports (shares), you could scan for the default port of 2049 but it's better to use nmap to scan for RPC ports that are open and query the service to see if the server is running NFS.  

```bash
# Example
nmap -sV -p 111 --script=rpcinfo 10.11.1.1-254
```

After finding an NFS export, you can run additional scans against it, but use the RPC port, not the port that it reported NFS running on in the previous step.

```bash
# All scripts
nmap -p 111 --script nfs* 10.11.1.72
```

This will give more information, including share names.

Once an NFS export is discovered, it can be mounted (with credentials or anonymously) using the mount command:

```bash
sudo mount -o nolock,nfsvers=3 10.11.1.72:/REMOTEDIR ~/LOCALDIR/
```

If a file is found but is protected, try creating a local user with the same UID or GID as the one with permissions on the file.  

NOTE:  If the UID is showing up as 'nobody' or 65534, try mounting with a different NFS version.  This is because NFS version 4 will re-set the permissions automatically so everyone can use the file system, but if it encounters an issue, it will mount as the 'nobody' user.  

```bash
# add user, note the UID it is created with
sudo adduser pwn
# Change the UID to match that of the file's owner
sudo sed -i -e 's/1000/1014/g' /etc/passwd
```

